<!doctype html>
<html>
	<head>
		<script src="https://leeoniya.github.io/uPlot/dist/uPlot.iife.min.js"></script>
		<link rel="stylesheet" href="https://leeoniya.github.io/uPlot/dist/uPlot.min.css">
		<script src="dta0.js"></script>
		<style>
		  html {font-family: Arial, Helvetica, sans-serif; }
			h1 { font-size: 14pt;}
			.toprow:after  {  content: ""; display: table; clear: both; }
			.topblk { float: left; border:solid;padding:4px;margin-bottom:4px;margin-right:4px;font-size:12px;height:180px; }
			</style>
		<meta charset="utf-8" />
	</head>
	<body>
		<h1>Subject_ID:00</h1>
		  <div class="toprow">
				<div class="topblk">
					<video id="v0" tabindex="0", autobuffer preload width="320" height="180" controls>
			        <source type='video/mp4;codecs="avc1.42E01E, mp4a.40.2"' src="s0.mp4"></source>
			    </video>
				</div>
				<div class="topblk">
					Gender: male<br/>Hand: right<br/>Age:≥40<br/>
					Height: 180-189 cm.<br/>Weight: 70-79 kg.
					<hr/>Private Workouts:<br/>Cycling<br/>Frequency: 5
					<hr/>Known Activities: 5,<br/> Regular Activities: 0
				</div>
				<div class="topblk">Session 1<hr/>Duration: 16:33:30<hr/>Activities: 7<hr/>Month: mid-Oct.<br/>morning<hr/> sunny, ≈10◦C<hr/> Location_ID: 1</div>
				<div class="topblk">Session 2<hr/>Duration: 11:55:00<hr/>Activities: 6<hr/>Month: mid-Oct.<br/>afternoon<hr/> partly-cloudy, ≈10◦C<hr/> Location_ID: 1</div>
				<div class="topblk">Session 3<hr/>Duration: 18:06:00<hr/>Activities: 7<hr/>Month: late-Oct.<br/>afternoon<hr/> partly-cloudy, ≈20◦C<hr/> Location_ID: 1</div>
				<div class="topblk">Data Files:<hr/>
					<a href="https://uni-siegen.sciebo.de/s/enHPo7HwP8RccAe/download?path=%2Fraw%2Fcamera&files=sbj_0.mp4">Video [7Gb]</a><br/>
					<a href="https://uni-siegen.sciebo.de/s/enHPo7HwP8RccAe/download?path=%2Fraw%2Finertial%2F50hz&files=sbj_0.csv">IMU sensors [33Mb]</a></div>
				</div>
			</div>
    <script>
		var vid = document.getElementById('v0'), width = window.innerWidth
		const data = [[...Array(raX.length).keys()], raX, raY, raZ, laX, laY, laZ, rlX, rlY, rlZ, llX, llY, llZ ];
		function bgAnns() {
			function drawBg(u) {
				let { left, top, width, height } = u.bbox;
				let { scale } = u.series[0];
				console.log(u.series)
				u.ctx.save();
				pos = [0, 9, 993, 1163, 1748, 1782, 2397, 2603, 3662, 3937, 4903, 4928, 5318, 5393, 6414, 6507, 7081, 7107, 7477, 7515, 7885, 7995, 8327, 8414, 8710, 8848, 9437, 9569, 9892, 9940, 10459, 10493, 11544, 11611, 12420, 12544, 13079, 13309, 14095, 14370, 15132, 15313, 17046, 17144, 17511, 17824, 18273, 18622, 18942, 19221, 20364, 20639, 21302, 21428, 21982, 22318, 22719, 22874, 23223, 23413, 23739, 24032, 25863, 26387, 27347, 27576, 27855]
				lbl = ['null', 'jogging', 'null', 'jogging', 'null', 'jogging', 'null', 'stretching (triceps)', 'null', 'jogging (rotating arms)', 'null', 'jogging (rotating arms)', 'null', 'stretching (lunging)', 'null', 'jogging (skipping)', 'null', 'jogging (skipping)', 'null', 'jogging (skipping)', 'null', 'push-ups', 'null', 'push-ups', 'null', 'push-ups (complex)', 'null', 'push-ups (complex)', 'null', 'jogging (sidesteps)', 'null', 'jogging (sidesteps)', 'null', 'stretching (shoulders)', 'null', 'sit-ups', 'null', 'stretching (hamstrings)', 'null', 'sit-ups (complex)', 'null', 'lunges', 'null', 'burpees', 'null', 'burpees', 'null', 'burpees', 'null', 'stretching (lumbar rotation)', 'null', 'jogging (butt-kicks)', 'null', 'jogging (butt-kicks)', 'null', 'bench-dips', 'null', 'bench-dips', 'null', 'bench-dips', 'null', 'lunges (complex)', 'null', 'sit-ups', 'null', 'push-ups', 'null']
				u.ctx.font = "14px Arial";
				for (var i=0; i<pos.length-1; i++) {
					if (lbl[i]!='null') {
						startPos = u.valToPos(pos[i], scale, true)
						width = u.valToPos(pos[i+1], scale, true)-startPos
						if (lbl[i].includes('jog')) u.ctx.fillStyle = '#FFFFD0';
						else if (lbl[i].includes('stretch')) u.ctx.fillStyle = '#D0FFD0';
						else if (lbl[i].includes('burp')) u.ctx.fillStyle = '#FFD0D0';
						else if (lbl[i].includes('lung')) u.ctx.fillStyle = '#FFD0FF';
						else u.ctx.fillStyle = '#D0D0FF';
						u.ctx.fillRect(startPos, top, width, height+20);  // left, width for each annotation
						u.ctx.fillStyle = 'black';
						u.ctx.fillText(lbl[i], startPos, 707)  // annotation
					}
				}
				u.ctx.font = "24px Arial";
				u.ctx.textAlign = 'left';
				u.ctx.fillText("right hand", 7, 24); u.ctx.fillText("left hand", 7, 200);
				u.ctx.fillText("right ankle", 7, 380); u.ctx.fillText("left ankle", 7, 560);
				u.ctx.restore();
			}
			return { hooks: { drawClear: drawBg } };  // return hook
		}
    let opts = {
      id: "chart1",
      width: window.innerWidth-9,
      height: 400,
      series: [
        { fill:false, ticks:{show:false}},
        { label:'rax',stroke:'red'},{ label:'ray',stroke:'green'},{ label:'raz',stroke:'blue'},
				{ label:'lax',stroke:'red'},{ label:'lay',stroke:'green'},{ label:'laz',stroke:'blue'},
				{ label:'rlx',stroke:'red'},{ label:'rly',stroke:'green'},{ label:'rlz',stroke:'blue'},
				{ label:'llx',stroke:'red'},{ label:'lly',stroke:'green'},{ label:'llz',stroke:'blue'},
      ],
     	cursor: { bind: {  // capture mouse down
					mousedown: (u, targ, handler) => {
						return e => { vid.currentTime = Math.floor( (vid.duration*e.offsetX) / (u.width-50) );}  // TODO: Get better div width
					}, }, y : false, // hide horizontal crosshair
			},
			plugins: [ bgAnns(),],
      axes: [ {}, { scale: "readings", side: 1, grid: {show: true},}, ],
      scales: { auto: false, "x": { time: false, }, y: { range: { max:160, min:-200,  }} },
      legend: { show: false, },
    };
    let uplot = vid.onseeking = new uPlot(opts, data, document.body);
    vid.onplay = vid.onseeking = function() {
			pos = Math.floor((vid.currentTime / vid.duration)*data[0].length)
			uplot.setCursor({
        left: uplot.valToPos(uplot.data[0][pos], 'x'), top:  uplot.valToPos(uplot.data[1][pos], 'y'),
      });
		}
		</script>
		<script>
			var grph = document.getElementById('chart1'); grph.style.border="solid"
		</script>
	</body>
</html>
